Option ExplicitSub GenerateSummary()    Dim targetSymbols As String    Dim tabList() As Variant    Dim symbolList() As String    Dim symbol As Variant        Dim tabnum As Variant    Dim lastRow As Long        Dim currentSymbol As String        Dim c As Range    Dim rngG As Range        Dim outWB As Workbook    ' list of tabs to generate summary from    tabList() = Array(1, 2, 3)        ' prompt user    targetSymbols = InputBox("Symbols to include in summary (space separated):")    symbolList() = Split(targetSymbols)    ' specify outfile     Dim outFilename As String     outFilename = "/Users/rogerho/Desktop/test.xls"          ' attach origin file to var     Dim dataFile As Workbook     Set dataFile = ActiveWorkbook             If Len(Join(symbolList)) > 0 Then        'Array contains values        Set outWB = Workbooks.Add    End If               For Each symbol In symbolList()        ' create new sheet for each symbol        outWB.Sheets.Add(After:=outWB.Sheets(outWB.Sheets.Count)).Name = symbol                For Each tabnum In tabList                        ' search rows for symbol             With dataFile                 For Each c In dataFile.Sheets(tabnum).UsedRange.Rows                   currentSymbol = c.Columns(7)                   currentSymbol = RTrim(currentSymbol)                                      If currentSymbol = symbol Then                       If rngG Is Nothing Then Set rngG = c                       Set rngG = Union(rngG, c)                   End If                Next c            End With                        ' disable alerts            Application.DisplayAlerts = False                        ' add new sheet and find last row            lastRow = outWB.Sheets(symbol).Cells(Rows.Count, "A").End(xlUp).Row + 1                        ' demarc each client            outWB.Sheets(symbol).Range("A" & lastRow).Value = dataFile.Sheets(tabnum).Name                        lastRow = outWB.Sheets(symbol).Cells(Rows.Count, "A").End(xlUp).Row + 1                        ' check if symbol exists on sheet            If Not rngG Is Nothing Then                    ' special copy                    rngG.Copy                    outWB.Sheets(symbol).Range("A" & lastRow & ":" & "Z" & lastRow).PasteSpecial xlPasteColumnWidths                    ' bypass stupid clipboard                    rngG.Copy Destination:=outWB.Sheets(symbol).Range("A" & lastRow & ":" & "Z" & lastRow)            End If                        ' clear clipboard and clear c, rngG             Set rngG = Nothing             Set c = Nothing            Application.CutCopyMode = False                                Next tabnum                outWB.Sheets(symbol).Range("A1:Z1").Delete Shift:=xlUp    Next symbol    If Len(Join(symbolList)) > 0 Then        'Array contains values        If outWB.Sheets.Count > 1 Then            outWB.Sheets("Sheet1").Delete        End If    End If     'outWB.SaveAs FileName:=outFilename    End Sub